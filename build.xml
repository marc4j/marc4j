<?xml version="1.0" encoding="utf-8"?>
<project name="marc4j" default="jar" basedir=".">

  <target name="init">
    <tstamp/>
    <property name="src" value="src"/>
    <property name="build" value="build"/>
    <property name="dist" value="dist"/>
    <property name="apidoc" value="${dist}/doc/apidoc"/>
    <property name="version" value="b6a"/>
    <property name="name" value="marc4j"/>
  </target>

  <target name="prepare" depends="init">
    <mkdir dir="${build}"/>
  </target>

  <target name="compile" depends="prepare">
    <javac srcdir="${src}" destdir="${build}"/>
  </target>

  <target name="jar" depends="compile">
    <mkdir dir="${dist}/lib"/>
    <jar jarfile="${dist}/lib/marc4j.jar" basedir="${build}"/>
  </target>

  <target name="javadoc" depends="init">
    <mkdir dir="${apidoc}"/>
    <javadoc packagenames="org.marc4j.*,org.marc4j.marc.*,org.marc4j.helpers.*,org.marc4j.util.*"
           sourcepath="src"
           destdir="${dist}/apidoc"
           author="true"
           version="true"
           use="true"
           windowtitle="${name}"
           doctitle="${name}"
           bottom="Copyright &#169; 2001-2002 Bas Peters. All Rights Reserved.">
      <link offline="true" href="http://java.sun.com/products/jdk/1.4/docs/api/" packagelistLoc="."/>
    </javadoc>
  </target>

  <target name="clean" depends="init">
    <deltree dir="${dist}" />
    <deltree dir="${build}" />
  </target>

  <target name="dist" depends="init">
    <mkdir dir="${dist}"/>
    <property name="prefix" value="marc4j-${version}"/>
    <property name="tmp_dir" value="${dist}/tmp"/>
    <property name="dist_dir" value="${tmp_dir}/${prefix}"/>
    <property name="dist_arc" value="${dist}/${prefix}"/>
    <mkdir dir="${dist_dir}"/>
    <copydir src="${dist}/apidoc" dest="${dist_dir}/doc/apidoc"/>
    <copydir src="${dist}/lib" dest="${dist_dir}/lib"/>
    <copydir src="${src}" dest="${dist_dir}/src"/>
    <copydir src="./www/doc" includes="index.html" dest="${dist_dir}/doc"/>
    <copydir src="." includes="gpl.txt, build.xml, build.bat, MARC21slim.rng, MARC21slim.dtd" dest="${dist_dir}/"/>
    <tar tarfile="${dist_arc}.tar" basedir="${tmp_dir}"/>
    <gzip zipfile="${dist_arc}.tar.gz" src="${dist_arc}.tar"/>
    <delete file="${dist_arc}.tar"/>
    <delete file="${dist_arc}.zip"/>
    <zip compress="true" basedir="${tmp_dir}" zipfile="${dist_arc}.zip"/>
    <deltree dir="${tmp_dir}"/>
  </target>

</project>